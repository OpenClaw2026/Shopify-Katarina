{% if section.settings.enable_collection %}

{% assign productIndex = forloop.index | minus:1 %}
{% assign delayTime = settings.time_lazy_load | times : productIndex %}

<div class="collection-list collection-list--{{ section.id }} container">
  <div class="page-width">
    {% if section.settings.title != blank %}
      <div class="widget-title wow fadeIn animated">   
       <fieldset class="box-title">
          <legend align="center">{% include 'multilang' with section.settings.title %}</legend>
       </fieldset>    
      </div>
    {% endif %}
    <div class="grid grid--uniform row">

      {% for block in section.blocks limit: section.blocks.size %}

        {% case section.settings.grid %}
          {% when 1 %}
            {%- assign grid_item_width = 'col-xs-12' -%}
          {% when 2 %}
            {%- assign grid_item_width = 'col-xs-12 col-sm-6 col-sm-4 col-lg-6' -%}
          {% when 3 %}
            {%- assign grid_item_width = 'col-xs-12 col-sm-6 col-sm-4 col-lg-4' -%}
          {% when 4 %}
            {%- assign grid_item_width = 'col-xs-12 col-sm-6 col-sm-4 col-lg-3' -%}
          {% else %}
            {%- assign grid_item_width = 'col-xs-12 col-sm-6 col-sm-4 col-lg-4' -%}
        {% endcase %}

        {%- assign collection = collections[block.settings.collection] -%}
      {%- assign collection_image1 = block.settings.collection_image1 -%}
		
        {% if collection == empty %}
          {% comment %}add default state for collection block in storefront editor{% endcomment %}
          {% capture collection_title %}Your collection's name{% endcapture %}
        {% else %}
          {% capture collection_title %}{{ collection.title | escape }}{% endcapture %}
        {% endif %}
		 {%- assign collection_image = '' %}
      {% if collection_image1 %}
     
      	  {% assign no_collection_image = false %}
          {%- assign collection_image = collection_image1 -%}
        {% elsif collection.image %}
          {% assign no_collection_image = false %}
          {%- assign collection_image = collection.image -%}
        {% elsif collection.products.first and collection.products.first.images != empty %}
          {%- assign collection_image = collection.products.first.featured_image -%}
        {% else %}
          {%- assign collection_image = blank -%}
        {% endif %}
     
        <div class="grid__item {{ grid_item_width }} wow fadeIn" data-wow-delay="{{delayTime}}ms" {{ block.shopify_attributes }} id="collection-{{block.id}}">
          <div class="collection-list-grid__image-item">
            <div class="collection-list-grid__image-container">
              <a href="{{ collection.url }}" class="collection-list-grid__link">
                <div class="collection-list-grid__image-wrapper">
                  {% unless collection_image == blank %}
                    <noscript>
                      <div class="collection-grid-item__image" style="background-image: url({{ collection_image | img_url: '1024x1024' }})"></div>
                    </noscript>
                    <div class="collection-grid-item__image">
                      {% if collection_image %}
                      <img src="{{ collection_image | img_url:'master' }}" alt="{{ collection_title }}">
                      {%- comment -%}{{ collection_image | collection_img_url: 'large' | img_tag: collection_title }}{%- endcomment -%}
                      {% elsif collection.image %}
                      {{ collection.image.src | collection_img_url: 'large' | img_tag: collection_title }}
                      {% else %}
                      {{ collection.products.first.featured_image | product_img_url: 'large' | img_tag: collection_title }}
                      {% endif %}
                    </div>
                  {% else %}
                    {% if collection == empty %}
                      <div class="collection-grid-item__image">
                        {% capture current %}{% cycle 1, 2, 3 %}{% endcapture %}
                        {{ 'collection-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
                      </div>
                    {% else %}
                      <div class="collection-grid-item__image" style="background-image: url({{ collection_image | img_url: '1024x1024' }})"></div>
                    {% endif %}
                  {% endunless %}
                </div>
                <div class="hover_collection">
            		<div class="collection_desc">{{ collection.description | strip_html | truncatewords: 17 }}</div>
            		<div class="count-products" {% if settings.enable_multilang %}data-translate="collections.general.items_with_count|count:{{collection.all_products_count}}"{% endif %}>{{ 'collections.general.items_with_count' | t: count: collection.all_products_count }}</div>
               </div>
              </a>
            </div>
            
            <div class="collection-grid-item-title">
              <div class="collection_type">{% include 'multilang' with block.settings.text_type %}</div>
              <h3 class="text-title">{% include'multilang' with collection_title %}</h3>
              
              <a href="{{ collection.url }}" class="collection-btn" {% if settings.enable_multilang %}data-translate="collections.general.shop_the_collection"{% endif %}>{{ 'collections.general.shop_the_collection' | t }}
              	<i class="fa fa-angle-right"></i>
              </a>
            </div>
            
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endif %}
{% schema %}
{
    "name": "Collection list",
    "class": "index-section",
    "max_blocks": 15,
    "settings": [
	  {
		"type" : "checkbox",
		"id" : "enable_collection",
		"label" : "Enable",
		"default" : true
      },
      {
        "type": "text",
        "id": "title",
        "label": "Heading",
        "default": "Collection list"
      },
      {
        "type": "range",
        "id": "grid",
        "label": "Collections per row",
        "min": 2,
        "max": 4,
        "step": 1,
        "default": 3
      },
	  {
		"type" : "text",
		"id" : "font_size_type",
		"label" : "Font size type",
		"default" : "12px"
	  },
	  {
		"type" : "color",
		"id" : "color_col_type",
		"label" : "Color type"
      },
	  {
		"type" : "text",
		"id" : "font_size_title",
		"label" : "Font size Title",
		"default" : "20px"
	  },
	  {
		"type" : "color",
		"id" : "color_col_title",
		"label" : "Color title"
      },
      {
		"type" : "text",
		"id" : "font_size_btn",
		"label" : "Font size Button",
		"default" : "13px"
	  },
	  {
		"type" : "color",
		"id" : "color_col_btn",
		"label" : "Color Button"
      },
	  {
		"type" : "text",
		"id" : "font_size_des",
		"label" : "Font size Description",
		"default" : "12px"
	  },
	  {
		"type" : "color",
		"id" : "color_col_des",
		"label" : "Color Description"
      },
	  {
		"type" : "color",
		"id" : "border_bottom_color",
		"label" : "Border color bottom"
      }
    ],
    "blocks": [
      {
        "type": "collection",
        "name": "Collection",
        "settings": [
          {
            "type": "collection",
            "id": "collection",
            "label": "Collection"
          },
		  {
			"type" : "text",
			"id" : "text_type",
			"label" : "Text Type"
          },
		  {
			"type" : "image_picker",
			"id" : "collection_image1",
			"label" : "Image"
          }	
        ]
      }
    ],
    "presets": [
      {
        "name": "Collection list",
        "category": "Collection",
        "blocks": [
          {
            "type": "collection"
          },
          {
            "type": "collection"
          },
          {
            "type": "collection"
          }
        ]
      }
    ]
  }{% endschema %}
<style>
.collection-grid-item-title .text-title{
    font-size: {{ section.settings.font_size_title }};
    color: {{section.settings.color_col_title}};
}
.collection-grid-item-title .collection_type{
    font-size: {{ section.settings.font_size_type }};
    color: {{section.settings.color_col_type}};

}
.collection-grid-item-title .collection-btn{
    font-size: {{ section.settings.font_size_btn }};
    color: {{ section.settings.color_col_btn }};

}

.collection-grid-item-title {
  	border-bottom: 3px solid {{section.settings.border_bottom_color}};
}
.collection-btn:before {
    background: {{ section.settings.color_col_btn }};

}

.collection_desc{
  	color: {{section.settings.color_col_des}};
}
</style>